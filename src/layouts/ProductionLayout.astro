---
import BaseLayout from "./BaseLayout.astro";
import "../styles/markdown.css";

const { frontmatter } = Astro.props;
---

<BaseLayout title={frontmatter.title}>
  <article class="markdown-content">
    <slot />
  </article>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox">
    <img id="lightbox-img" src="" alt="" />
  </div>

  <script>
    const lightbox = document.getElementById('lightbox');
    const lightboxImg = document.getElementById('lightbox-img') as HTMLImageElement;
    const galleryImages = document.querySelectorAll('.gallery img');

    galleryImages.forEach(img => {
      img.addEventListener('click', () => {
        lightboxImg.src = (img as HTMLImageElement).src;
        lightbox.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent scrolling
      });
    });

    lightbox?.addEventListener('click', () => {
      lightbox.classList.remove('active');
      document.body.style.overflow = ''; // Restore scrolling
    });

    // Close on Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && lightbox.classList.contains('active')) {
        lightbox.classList.remove('active');
        document.body.style.overflow = '';
      }
    });
  </script>
</BaseLayout>
